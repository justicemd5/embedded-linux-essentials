# U-Boot Falcon Mode Configuration
# Add these options to am335x_boneblack_defconfig or apply via menuconfig
#
# These enable SPL to boot Linux kernel directly, bypassing full U-Boot

# Core Falcon Mode support
CONFIG_SPL_OS_BOOT=y

# Enable Falcon boot from MMC/SD
CONFIG_SPL_FALCON_BOOT_MMCSD=y

# Memory address for kernel arguments (FDT blob)
CONFIG_SYS_SPL_ARGS_ADDR=0x80F80000

# SPL needs environment access to read falcon_slot
CONFIG_SPL_ENV_SUPPORT=y

# SPL needs MMC support (already enabled for BBB)
CONFIG_SPL_MMC_SUPPORT=y

# GPIO support for fallback button detection
CONFIG_SPL_GPIO_SUPPORT=y

# Enable 'spl export' command in full U-Boot
CONFIG_CMD_SPL=y

# Optional: Enable SPL serial output for debugging
CONFIG_SPL_SERIAL_SUPPORT=y

# Build command:
# cd u-boot
# make CROSS_COMPILE=arm-linux-gnueabihf- distclean
# make CROSS_COMPILE=arm-linux-gnueabihf- am335x_boneblack_defconfig
# # Apply above configs via menuconfig or:
# cat >> .config << 'EOF'
# CONFIG_SPL_OS_BOOT=y
# CONFIG_SPL_FALCON_BOOT_MMCSD=y
# CONFIG_SYS_SPL_ARGS_ADDR=0x80F80000
# CONFIG_SPL_ENV_SUPPORT=y
# CONFIG_CMD_SPL=y
# EOF
# make CROSS_COMPILE=arm-linux-gnueabihf- -j$(nproc)
