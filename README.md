# Embedded Linux Labs

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Platform: BeagleBone Black](https://img.shields.io/badge/Platform-BeagleBone%20Black%20Rev.C-green)](https://beagleboard.org/black)
[![Auto-Generated](https://img.shields.io/badge/Content-AI%20Generated-purple)]()

---

## ‚ö†Ô∏è DISCLAIMER

> **This entire repository was auto-generated by an AI assistant (GitHub Copilot / Claude).**
>
> While every effort has been made to ensure accuracy, the content has not been manually verified on physical hardware. Users should:
> - Verify all commands and procedures before executing on real hardware
> - Cross-reference with official documentation (BeagleBoard.org, kernel.org, u-boot.org)
> - Report any errors or inaccuracies via GitHub issues
> - Use at their own risk
>
> **Generated:** January 2024  
> **Last Updated:** January 2026

---

## üìù Initial Generation Query

This repository was generated from the following prompt:

> *"Create a complete GitHub repository named 'embedded-linux-labs' for teaching Embedded Linux system bring-up using BeagleBone Black Rev. C as the primary target. Generate all source code, scripts, diagrams, and documentation with no placeholders. Include labs covering boot flow, U-Boot (including SPL), kernel building, device trees, initramfs, NFS boot, and recovery techniques. All tutorials should include conceptual explanations, real-world importance, step-by-step commands, ASCII diagrams, common mistakes/debugging tips, and 'what you learned' sections. Include graded exercises (beginner/intermediate/advanced)."*

---

A comprehensive, hands-on educational repository for learning Embedded Linux system bring-up, boot flow, and development. This repository is designed for engineers, students, and professionals who want to deeply understand how Embedded Linux systems work from power-on to user space.

## üéØ Learning Objectives

After completing these labs, you will be able to:

- ‚úÖ Configure and compile Embedded Linux images from source
- ‚úÖ Deeply understand the complete boot flow (ROM ‚Üí SPL ‚Üí U-Boot ‚Üí Kernel ‚Üí Userspace)
- ‚úÖ Understand bootloader stages and design constraints
- ‚úÖ Recover a "bricked" board using pre-built images and TFTP/UART
- ‚úÖ Understand how all Embedded Linux components link together
- ‚úÖ Use bootargs to boot via SD card, initramfs, and NFS
- ‚úÖ Work confidently with U-Boot internals and environment variables
- ‚úÖ Persist U-Boot environment to SD card
- ‚úÖ Add custom U-Boot commands in C
- ‚úÖ Build and customize the Linux kernel
- ‚úÖ Understand and modify device trees
- ‚úÖ Create minimal initramfs filesystems
- ‚úÖ Set up NFS boot for rapid development

## üìã Prerequisites

### Hardware (Required)

| Item | Specification | Purpose |
|------|---------------|---------|
| **BeagleBone Black Rev. C** | AM335x Cortex-A8, 512MB DDR3 | Primary target platform |
| **microSD Card** | 8GB minimum, Class 10 | Boot media and root filesystem |
| **Power Supply** | 5V / 3A DC barrel jack | Reliable power (USB may be insufficient) |
| **USB Programming Cable** | Mini-USB to USB-A | Serial console access via /dev/ttyACM0 |
| **HDMI Cable** | Micro-HDMI to HDMI | Optional: Video output |
| **Ethernet Cable** | CAT5e or better | NFS/TFTP network boot labs |

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    BEAGLEBONE BLACK REV. C SETUP                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                             ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îÇ
‚îÇ    ‚îÇ                  BeagleBone Black                       ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ  ‚îÇ SD   ‚îÇ‚óÑ‚îÄ‚îÄ 8GB microSD Card                ‚îÇ ETH  ‚îÇ‚óÑ‚îÄ‚îÄ‚îº‚îÄ‚îÄ Ethernet  ‚îÇ
‚îÇ    ‚îÇ  ‚îÇ Slot ‚îÇ    (Boot media)                    ‚îÇ Port ‚îÇ   ‚îÇ   Cable     ‚îÇ
‚îÇ    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ                                                         ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ  ‚îÇ USB  ‚îÇ‚óÑ‚îÄ‚îÄ USB Programming Cable           ‚îÇ 5V   ‚îÇ‚óÑ‚îÄ‚îÄ‚îº‚îÄ‚îÄ 5V/3A PSU ‚îÇ
‚îÇ    ‚îÇ  ‚îÇ Mini ‚îÇ    (Serial: /dev/ttyACM0)          ‚îÇ Jack ‚îÇ   ‚îÇ             ‚îÇ
‚îÇ    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ                                                         ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    BOOT button (hold for SD boot)             ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ  ‚îÇ uHDMI‚îÇ‚óÑ‚îÄ‚îÄ Micro-HDMI Cable (optional)                ‚îÇ              ‚îÇ
‚îÇ    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                               ‚îÇ              ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ    BOOT MODES:                                                              ‚îÇ
‚îÇ    ‚Ä¢ Normal: Boots from eMMC (onboard flash)                                ‚îÇ
‚îÇ    ‚Ä¢ SD Boot: Hold BOOT button during power-on ‚Üí boots from SD card         ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

> ‚ö†Ô∏è **Important**: The USB port alone may not provide sufficient power. Always use the 5V/3A barrel jack power supply for reliable operation, especially when using peripherals.

### Software (Host Machine)
- Linux host machine (Ubuntu 20.04/22.04/24.04 LTS recommended)
- Cross-compilation toolchain: `arm-linux-gnueabihf-` (32-bit ARM)
- Git, make, gcc, flex, bison, libssl-dev
- TFTP server and NFS server (for network boot labs)
- minicom or picocom (for serial console)

### Knowledge
- Basic Linux command line proficiency
- Basic C programming understanding
- Familiarity with Makefiles (helpful but not required)

## üìÅ Repository Structure

```
embedded-linux-labs/
‚îú‚îÄ‚îÄ README.md                      # This file
‚îú‚îÄ‚îÄ build_all.sh                   # Master build orchestration script
‚îÇ
‚îú‚îÄ‚îÄ diagrams/                      # Visual learning aids
‚îÇ   ‚îú‚îÄ‚îÄ boot_flow.md               # Boot flow diagram (Mermaid)
‚îÇ   ‚îú‚îÄ‚îÄ boot_flow_ascii.txt        # ASCII art boot flow
‚îÇ   ‚îî‚îÄ‚îÄ component_linkage.md       # How components connect
‚îÇ
‚îú‚îÄ‚îÄ docs/                          # Comprehensive documentation
‚îÇ   ‚îú‚îÄ‚îÄ embedded_linux_components.md
‚îÇ   ‚îú‚îÄ‚îÄ bootloader_stages.md
‚îÇ   ‚îú‚îÄ‚îÄ bootloader_design_constraints.md
‚îÇ   ‚îú‚îÄ‚îÄ spl_guide.md               # SPL (Secondary Program Loader) deep-dive
‚îÇ   ‚îú‚îÄ‚îÄ uboot_overview.md
‚îÇ   ‚îú‚îÄ‚îÄ uboot_spl_relationship.md  # How SPL and U-Boot work together
‚îÇ   ‚îú‚îÄ‚îÄ kernel_building.md
‚îÇ   ‚îú‚îÄ‚îÄ device_tree.md
‚îÇ   ‚îú‚îÄ‚îÄ initramfs.md
‚îÇ   ‚îú‚îÄ‚îÄ nfs_boot.md
‚îÇ   ‚îú‚îÄ‚îÄ bootargs_reference.md
‚îÇ   ‚îî‚îÄ‚îÄ recovery_guide.md
‚îÇ
‚îú‚îÄ‚îÄ 01_boot_flow/                  # Lab 1: Understanding Boot Flow
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ 02_uboot/                      # Lab 2: U-Boot Bootloader
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ build_uboot.sh
‚îÇ   ‚îú‚îÄ‚îÄ env_sdcard/                # Persisting U-Boot environment
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ uboot_env_config.txt
‚îÇ   ‚îî‚îÄ‚îÄ custom_cmd/                # Adding custom U-Boot commands
‚îÇ       ‚îú‚îÄ‚îÄ README.md
‚îÇ       ‚îú‚îÄ‚îÄ cmd_hello.c
‚îÇ       ‚îî‚îÄ‚îÄ Makefile.patch
‚îÇ
‚îú‚îÄ‚îÄ 03_kernel/                     # Lab 3: Linux Kernel
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ build_kernel.sh
‚îÇ   ‚îî‚îÄ‚îÄ kernel_config_notes.md
‚îÇ
‚îú‚îÄ‚îÄ 04_device_tree/                # Lab 4: Device Tree
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îî‚îÄ‚îÄ led_example.dts
‚îÇ
‚îú‚îÄ‚îÄ 05_initramfs/                  # Lab 5: Initial RAM Filesystem
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ create_initramfs.sh
‚îÇ   ‚îî‚îÄ‚îÄ init
‚îÇ
‚îú‚îÄ‚îÄ 06_nfs_boot/                   # Lab 6: Network Boot
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îî‚îÄ‚îÄ setup_nfs_server.md
‚îÇ
‚îú‚îÄ‚îÄ 07_recovery/                   # Lab 7: Board Recovery
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ tftp_recovery.md
‚îÇ   ‚îî‚îÄ‚îÄ uart_debugging.md
‚îÇ
‚îî‚îÄ‚îÄ exercises/                     # Graded exercises
    ‚îú‚îÄ‚îÄ beginner.md
    ‚îú‚îÄ‚îÄ intermediate.md
    ‚îî‚îÄ‚îÄ advanced.md
```

## üöÄ Quick Start

### 1. Clone and Set Up Environment

```bash
# Clone the repository
git clone https://github.com/your-username/embedded-linux-labs.git
cd embedded-linux-labs

# Install host dependencies (Ubuntu/Debian)
sudo apt-get update
sudo apt-get install -y \
    git bc bison flex libssl-dev make libc6-dev libncurses5-dev \
    crossbuild-essential-armhf crossbuild-essential-arm64 \
    u-boot-tools device-tree-compiler \
    tftpd-hpa nfs-kernel-server \
    minicom picocom

# Set up cross-compiler (choose based on your target)
# For 32-bit ARM (RPi 2/3, BeagleBone):
export CROSS_COMPILE=arm-linux-gnueabihf-
export ARCH=arm

# For 64-bit ARM (RPi 3/4 in 64-bit mode):
export CROSS_COMPILE=aarch64-linux-gnu-
export ARCH=arm64
```

### 2. Connect to Your BeagleBone Black

```bash
# Connect USB programming cable - BBB has built-in USB-to-Serial
# The BBB appears as /dev/ttyACM0 when connected via USB
dmesg | grep tty
# Look for: cdc_acm 1-1:1.0: ttyACM0: USB ACM device

# Open serial console (115200 baud, 8N1)
minicom -D /dev/ttyACM0 -b 115200

# Or use picocom
picocom -b 115200 /dev/ttyACM0

# Or use screen
screen /dev/ttyACM0 115200
```

> **Note**: BeagleBone Black has a built-in FTDI chip, so no external USB-to-UART adapter is needed. Just connect the USB programming cable.

### 3. Follow the Labs in Order

1. **[01_boot_flow](01_boot_flow/README.md)** - Understand the complete boot sequence
2. **[02_uboot](02_uboot/README.md)** - Build and customize U-Boot
3. **[03_kernel](03_kernel/README.md)** - Build the Linux kernel
4. **[04_device_tree](04_device_tree/README.md)** - Understand device trees
5. **[05_initramfs](05_initramfs/README.md)** - Create initial RAM filesystem
6. **[06_nfs_boot](06_nfs_boot/README.md)** - Set up network boot
7. **[07_recovery](07_recovery/README.md)** - Learn recovery techniques

### 4. Build Everything

```bash
# Build all components for BeagleBone Black (primary target)
./build_all.sh bbb

# Alternative targets (may require additional configuration)
./build_all.sh rpi3     # Raspberry Pi 3
./build_all.sh imx6     # i.MX6
./build_all.sh stm32mp1 # STM32MP1
```

## üéì Learning Path

### Week 1: Foundations
- Read all documentation in `docs/`
- Complete Lab 01 (Boot Flow)
- Complete beginner exercises

### Week 2: Bootloader Deep Dive
- Complete Lab 02 (U-Boot)
- Practice environment persistence
- Add custom U-Boot command
- Complete intermediate exercises (U-Boot section)

### Week 3: Kernel and Device Tree
- Complete Lab 03 (Kernel)
- Complete Lab 04 (Device Tree)
- Practice kernel configuration

### Week 4: Advanced Topics
- Complete Lab 05 (Initramfs)
- Complete Lab 06 (NFS Boot)
- Complete Lab 07 (Recovery)
- Complete advanced exercises

## üîß Supported Platforms

| Platform | Architecture | Status | Notes |
|----------|-------------|--------|-------|
| BeagleBone Black Rev. C | ARM Cortex-A8 (AM335x) | ‚úÖ **Primary** | All tutorials based on this |
| Raspberry Pi 3B/3B+ | ARM Cortex-A53 | ‚ö™ Reference | Some examples provided |
| Raspberry Pi 4 | ARM Cortex-A72 | ‚ö™ Reference | 64-bit |
| i.MX6 Sabre | ARM Cortex-A9 | ‚ö™ Reference | NXP i.MX6 |
| STM32MP157 | ARM Cortex-A7 | ‚ö™ Reference | Dual Cortex-A7 + M4 |

## üìñ Documentation Overview

| Document | Description |
|----------|-------------|
| [Embedded Linux Components](docs/embedded_linux_components.md) | Overview of all system components |
| [Bootloader Stages](docs/bootloader_stages.md) | ROM, SPL, U-Boot explained |
| [Design Constraints](docs/bootloader_design_constraints.md) | Memory, storage, time, reliability |
| [SPL Guide](docs/spl_guide.md) | **NEW:** Secondary Program Loader deep-dive |
| [U-Boot Overview](docs/uboot_overview.md) | U-Boot internals and usage |
| [SPL/U-Boot Relationship](docs/uboot_spl_relationship.md) | **NEW:** How SPL and U-Boot work together |
| [Kernel Building](docs/kernel_building.md) | Complete kernel build guide |
| [Device Tree](docs/device_tree.md) | DTS/DTB fundamentals |
| [Initramfs](docs/initramfs.md) | Initial RAM filesystem |
| [NFS Boot](docs/nfs_boot.md) | Network filesystem boot |
| [Bootargs Reference](docs/bootargs_reference.md) | Kernel command line parameters |
| [Recovery Guide](docs/recovery_guide.md) | Unbricking techniques |

## üêõ Troubleshooting

### Common Issues

**No serial output:**
- BeagleBone Black uses /dev/ttyACM0 (built-in USB-to-Serial)
- Ensure USB programming cable is connected
- Verify baud rate is 115200
- Check user is in dialout group: `sudo usermod -a -G dialout $USER`

**Kernel panic - no init found:**
- Verify rootfs path in bootargs
- Check filesystem type matches bootargs
- Ensure init binary exists and is executable

**BeagleBone won't boot from SD card:**
- Hold the BOOT button (S2) while applying power
- Release after 2-3 seconds
- This forces boot from SD instead of eMMC

**U-Boot hangs:**
- Use 5V/3A barrel jack power supply (USB may be insufficient)
- Verify SD card is properly formatted (FAT32 for boot partition)
- Try different SD card (some cards are incompatible)

See [07_recovery/README.md](07_recovery/README.md) for comprehensive debugging.

## ü§ù Contributing

Contributions are welcome! Please:
1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Submit a pull request

## üìú License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üôè Acknowledgments

- The U-Boot project and maintainers
- The Linux kernel community
- Raspberry Pi Foundation
- BeagleBoard.org Foundation
- The Embedded Linux community

## üìß Contact

For questions, issues, or feedback, please open a GitHub issue.

---

**Happy Learning! üöÄ**

*"The best way to learn Embedded Linux is to build it from scratch."*
